<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yyhn.exam.mapper.PapersMapper">

    <resultMap id="papersAll" type="Papers">
        <id property="id" column="id"></id>
        <result property="name" column="name"></result>
        <result property="type" column="type"></result>
        <result property="sum" column="sum"></result>
        <result property="ispublish" column="ispublish"></result>
        <result property="papersName" column="papers_name"></result>
        <result property="buildPapersDate" column="build_papers_date"></result>
        <result property="papersStartDate" column="papers_start_date"></result>
        <result property="papersOverDate" column="papers_over_date"></result>
        <association property="professional" javaType="com.yyhn.exam.entity.Professional">
            <id property="id" column="professionalId"></id>
            <result property="professionalName" column="professional_name"></result>
        </association>
        <collection property="courseList" ofType="com.yyhn.exam.entity.Course">
            <id property="id" column="courseId"></id>
            <result property="courseName" column="course_name"></result>
        </collection>
<!--        <collection property="studentList" ofType="com.yyhn.exam.entity.Student">-->
<!--            <id property="id" column="studentId"></id>-->
<!--            <result property="classId" column="classId"></result>-->
<!--        </collection>-->
    </resultMap>

    <select id="getPapersAll" resultMap="papersAll">
        select exam_papers.*,exam_course.id courseId,exam_course.course_name,exam_professional.id professionalId,exam_professional.professional_name
        from exam_papers
        left join exam_papers_course on exam_papers.id = exam_papers_course.papers_id
        left join exam_course on exam_papers_course.course_id = exam_course.id
        join exam_professional on exam_papers_course.professional_id = exam_professional.id
--         join exam_papers_user on exam_papers.id = exam_papers_user.papers_id
--         left join exam_student on exam_papers_user.user_id = exam_student.id
        where 1=1
        <if test="name!=null and name!=''">
            and name like concat('%',#{name},'%')
        </if>
        <if test="papersName!=null and papersName!=''">
            and papers_name like concat('%',#{papersName},'%')
        </if>
        <if test="type!=null">
            and type = #{type}
        </if>
        <if test="course_id!=null">
            and exam_course.id = #{course_id}
        </if>
    </select>
</mapper>